<!DOCTYPE html>
<html>
<head>
    <title>Cynrith</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:400,700|Nunito:400,700|Merriweather+Sans:400,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=VT323&display=swap" rel="stylesheet">
    <link type="text/css" href="assets/css/root.css" rel="stylesheet" />
    <link type="text/css" href="assets/css/titleScreen.css" rel="stylesheet" />
    <link type="text/css" href="assets/css/hud.css" rel="stylesheet" />
    <link type="text/css" href="assets/css/dialogue.css" rel="stylesheet" />
    <link type="text/css" href="assets/css/playerMenu.css" rel="stylesheet" />
    <link type="text/css" href="assets/css/traderMenu.css" rel="stylesheet" />
    <link rel="manifest" href="manifest.json">
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("assets/js/core/service-worker.js");
      }
    </script>
</head>
<body>
    <canvas id="game"></canvas>

    <div id="log">
        <div id="fps"></div>
        <div id="coords"></div>
    </div>
    
    <div id="touch-joystick">
      <div id="joystick-base"></div>
      <div id="joystick-knob"></div>
    </div>

    <div id="act-controls">
      <button id="btn-a" class="act-btn">A</button>
      <button id="btn-b" class="act-btn">B</button>
    </div>
    
    <button id="menu-btn" class="menu-btn">Menu</button>
    <div id="player-menu" class="player-menu hidden">
      <div class="player-menu-content">
        <h1>Player Menu</h1>
        <button id="close-menu" class="close-btn">✕</button>
        <div class="player-menu-pages">
          <div class="player-menu-inner menu-page active">
            <div class="menu-left">
              <button class="menu-nav-btn" id="btn-inventory">Inventory</button>
              <button class="menu-nav-btn" id="btn-skills">Skills</button>
              <button class="menu-nav-btn" id="btn-quests">Quests</button>
              <button class="menu-nav-btn" id="btn-map">Map</button>
              <button class="menu-nav-btn" id="btn-save">Save Game</button>
              <button class="menu-nav-btn" id="btn-settings">Settings</button>
            </div>
            <div class="menu-right">
              <div id="player-sprite-preview"></div>
              <div id="player-stats-preview"></div>
            </div>
          </div>
          <div id="inventory-menu" class="menu-page">
            <button class="close-btn" onclick="showPlayerMenuMain()">✕</button>
            <h2>Inventory</h2>
            <div id="inventory-grid" class="inventory-grid"></div>
          </div>
          <div id="map-menu" class="menu-page">
            <button class="close-btn" onclick="showPlayerMenuMain()">✕</button>
            <h2>Current Floor Map</h2>
            <div>
              <div id="map-help-icon">?</div>
              <div id="map-help-tooltip" class="help-tooltip">
                <strong>Map Key:</strong><br>
                <span style="color:#3af07a;">● Green</span> - You (Player)<br>
                <span style="color:#3af0ff;">● Blue</span> - NPC<br>
                <span style="color:#ffe082;">● Gold</span> - NPC with quest ready<br>
                <span style="color:#e33;">● Red</span> - Enemy<br>
              </div>
            </div>
            <div id="map-preview-container">
              <canvas id="map-preview-canvas" width="320" height="180"></canvas>
            </div>
          </div>
          <div id="skills-menu" class="menu-page">
            <button class="close-btn" onclick="showPlayerMenuMain()">✕</button>
            <h2>Skills</h2>
            <div class="skills-block" id="equipped-skills-block">
              <h3>Equipped Skills</h3>
              <div id="equipped-skills">
                <div class="skill-slot" data-slot="1"></div>
                <div class="skill-slot" data-slot="2"></div>
                <div class="skill-slot" data-slot="3"></div>
              </div>
            </div>
            <div class="skills-block" id="skills-inventory-block">
              <h3>Inventory</h3>
              <div id="skills-inventory"></div>
            </div>
            <button id="spin-skills-btn" class="menu-nav-btn">Spin for Skills</button>
            <div id="skills-gacha-screen" class="hidden">
              <button class="close-btn" onclick="hideSkillsGachaScreen()">✕</button>
              <h3>Spin for a New Skill</h3>
              <div id="skills-gacha-reel"></div>
              <button id="skills-gacha-spin-blue" class="menu-nav-btn">
                <img src="assets/img/items/blue_gem.png" alt="Blue Gem" style="width:24px;vertical-align:middle;margin-right:8px;">
                Skills
              </button>
              <button id="skills-gacha-spin-red" class="menu-nav-btn">
                <img src="assets/img/items/red_gem.png" alt="Red Gem" style="width:24px;vertical-align:middle;margin-right:8px;">
                Skills
              </button>
              <button id="skills-gacha-spin-pink" class="menu-nav-btn">
                <img src="assets/img/items/pink_gem.png" alt="Pink Gem" style="width:24px;vertical-align:middle;margin-right:8px;">
                Skills
              </button>
            </div>
          </div>
          <!-- Add other menus here (skills, settings, etc.) -->
        </div>
      </div>
    </div>

    <div id="notification" class="notification"></div>

    <div id="dialogue-block" class="dialogue-block hidden">
      <div id="dialogue-npc-name" style="font-weight:bold;font-size:1.1em;color:#ffe082;margin-bottom:6px;"></div>
      <div id="dialogue-text"></div>
      <div id="dialogue-footer" style="margin-top:20px;font-size:0.6em;color:#ccc;"></div>
    </div>

    <div id="quest-hud" class="quest-hud"></div>

    <div id="trader-shop-menu" class="trader-shop-menu hidden">
      <div class="trader-shop-content">
        <button id="trader-shop-close" class="close-btn">✕</button>
        <h2 id="trader-shop-title">Trader Shop</h2>
        <div class="trader-shop-tabs">
          <button id="tab-buy" class="trader-tab active">Buy</button>
          <button id="tab-sell" class="trader-tab">Sell</button>
        </div>
        <div id="trader-shop-buy" class="trader-shop-page active"></div>
        <div id="trader-shop-sell" class="trader-shop-page"></div>
        <div class="trader-shop-coins">
          <span>Coins:</span>
          <span id="trader-shop-coins-amount">0</span>
          <img src="assets/img/items/coin.png" alt="Coin" style="width:22px;vertical-align:middle;margin-left:4px;">
        </div>
      </div>
    </div>

    <div id="screen-transition" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000;opacity:0;pointer-events:none;z-index:9999;transition:opacity 0.5s;"></div>
    
    <div id="preload-screen" class="preload-screen">
      <div class="preload-content">
        <h2 id="preload-title">Welcome to Cynrith</h2>
        <div id="preload-bar-container">
          <div id="preload-bar"></div>
        </div>
        <button id="enter-cynrith-btn" class="confirm-btn"></button>
      </div>
    </div>

    <div id="title-screen">
      <div id="title-effects">
        <div class="title-ray ray1"></div>
        <div class="title-ray ray2"></div>
        <div id="title-sparkles"></div>
      </div>
      <div class="title-content">
        <h1>Cynrith</h1>
        <button id="btn-newgame">New Game</button>
        <button id="btn-loadgame">Load Game</button>
      </div>
      <div id="title-fade"></div>
    </div>
    
    <div id="character-select" class="hidden">
      <div class="char-select-content">
        <button id="char-select-close" class="close-btn" title="Back to Title Menu">✕</button>
        <div id="help-icon">?</div>
        <div id="help-tooltip" class="help-tooltip">
          <strong>Choose your characters name.</strong><br>
          It must contain:<br>
          At least 8 Characters,<br>
          Upper and Lower case letters,<br>
          A Symbol or Number,<br>
          A Hieroglyph,<br>
          A Haiku,<br>
          A Musical Note,<br>
          The feather of a Phoenix,<br>
          And a drop of Unicorn Blood.<br>
          <br>
          <strong>In other words,</strong><br>
          Its your game save id,<br>
          Make it Unique to your other saves
        </div>
        <h2>Character Selection</h2>
        <input id="player-name-input" type="text" maxlength="16" placeholder="Enter your name..." autocomplete="off" />
        <div class="char-select-body">
          <ul id="char-list"></ul>
          <div id="char-preview-container">
            <canvas id="char-preview-canvas" width="96" height="96"></canvas>
          </div>
        </div>
        <button id="char-confirm-btn" class="confirm-btn">Confirm</button>
      </div>
    </div>

    <div id="load-game-menu" class="hidden">
      <div class="char-select-content">
        <button id="loadgame-close" class="close-btn" title="Back to Title Menu">✕</button>
        <h2>Load Game</h2>
        <ul id="save-list"></ul>
        <div class="load-btn-row">
          <button id="loadgame-confirm-btn" class="confirm-btn" disabled>Load Game</button>
          <button id="loadgame-delete-btn" class="confirm-btn danger-btn" disabled>Delete</button>
        </div>
      </div>
    </div>

    <div id="loading-screen" class="hidden">
      <div id="loading-carousel"></div>
      <div id="loading-bar-container">
        <div id="loading-bar"></div>
      </div>
    </div>

    <div id="lore-intro">
      <div id="lore-aura"></div>
      <div id="lore-text"></div>
      <button id="lore-skip-btn" class="lore-skip-btn" style="display:none;">Skip</button>
    </div>

    <script src="assets/js/DEFINITIONS/items.js"></script>
    <script src="assets/js/DEFINITIONS/interactTiles.js"></script>
    <script src="assets/js/DEFINITIONS/triggerTiles.js"></script>
    <script src="assets/js/DEFINITIONS/charactersData.js"></script>
    <script src="assets/js/DEFINITIONS/skills.js"></script>
    <script src="assets/js/DEFINITIONS/traders.js"></script>
    <script src="assets/js/DEFINITIONS/quests.js"></script>
    <script src="assets/js/DEFINITIONS/worldSprites.js"></script>
    <script src="assets/js/core/preload.js"></script>
    <script src="assets/js/core/soundManager.js"></script>
    <script src="assets/js/core/viewport.js"></script>
    <script src="assets/js/map/titleMap.js"></script>
    <script src="assets/js/ui/titleScreen.js"></script>
    <script src="assets/js/player/player.js"></script>
    <script src="assets/js/player/playerControls.js"></script>
    <script src="assets/js/map/map.js"></script>
    <script src="assets/js/map/mapInteractions.js"></script>
    <script src="assets/js/map/mapWarping.js"></script>
    <script src="assets/js/map/spriteLoader.js"></script>
    <script src="assets/js/quests/questHandlers.js"></script>
    <script src="assets/js/quests/questUI.js"></script>
    <script src="assets/js/npc/npc.js"></script>
    <script src="assets/js/npc/movement.js"></script>
    <script src="assets/js/npc/interactions.js"></script>
    <script src="assets/js/npc/npcTraders.js"></script>
    <script src="assets/js/player/playerDeath.js"></script>
    <script src="assets/js/core/main.js"></script>
    <script src="assets/js/core/saveLoad.js"></script>
    <script src="assets/js/ui/effects.js"></script>
    <script src="assets/js/inventory/inventory.js"></script>
    <script src="assets/js/inventory/itemEffects.js"></script>
    <script src="assets/js/ui/menu.js"></script>
    <script src="assets/js/ui/notify.js"></script>
    <script src="assets/js/ui/combatUi.js"></script>

</body>
</html>
